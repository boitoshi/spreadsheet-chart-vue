# スプレッドシート構成

ヘッダー定義は `shared/sheets_config.py` に一元管理。

## ポートフォリオ (12カラム A-L)

| 列 | カラム名 | 備考 |
|---|---|---|
| A | 銘柄コード | 例: 7974.T, NVDA |
| B | 銘柄名 | |
| C | 取得日 | 保有期間フィルタリングに使用 |
| D | 取得単価（円） | 日本株: 直接入力。外国株: 数式 `=E*F` |
| E | 取得単価（外貨） | 外国株のみ（USD等）。日本株は空欄 |
| F | 取得時為替レート | 外国株のみ。日本株は空欄 |
| G | 保有株数 | |
| H | 取得額合計 | 数式 `=D*G`（閲覧用） |
| I | 通貨 | JPY / USD / HKD（ISOコード） |
| J | 外国株フラグ | ○ / × |
| K | 最終更新 | |
| L | 備考 | |

## データ記録 (9カラム A-I)

| 列 | カラム名 |
|---|---|
| A | 月末日付 |
| B | 銘柄コード |
| C | 月末価格（円） |
| D | 最高値 |
| E | 最安値 |
| F | 平均価格 |
| G | 月間変動率(%) |
| H | 平均出来高 |
| I | 取得日時 |

## 損益レポート (16カラム A-P)

| 列 | カラム名 |
|---|---|
| A-K | 日付, 銘柄コード, 銘柄名, 取得単価, 月末価格, 保有株数, 取得額, 評価額, 損益, 損益率(%), 更新日時 |
| L | 通貨 |
| M | 取得単価（外貨） |
| N | 月末価格（外貨） |
| O | 取得時為替レート |
| P | 現在為替レート |

## 為替レート (8カラム A-H)

取得日, 通貨ペア, レート, 前回レート, 変動率(%), 最高値, 最安値, 更新日時

## 損益分離計算式

```
株価損益 = (月末外貨価格 - 取得外貨価格) × 取得時為替レート × 株数
為替損益 = (現在為替レート - 取得時為替レート) × 月末外貨価格 × 株数
総損益   = 株価損益 + 為替損益（= 評価額 - 取得額）

不変条件: D列（取得単価円）= E列（外貨単価）× F列（取得時為替レート）
```
